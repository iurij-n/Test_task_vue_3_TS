<script setup lang="ts">
import { inject } from 'vue';

const props = defineProps<{
  title: string;
  totalCount: number;
}>();

const {
  deleteSelectedUsers,
  exportToCSV,
  filterRole,
  isLoading,
  openAddUserModal,
  searchQuery,
  selectedUsers,
  showAllUsers
} = inject('userTableState')!;
</script>

<template>
  <div class="table-header">
    <div class="header-left">
      <h2>{{ props.title }}</h2>
      <span class="total-count">{{ props.totalCount }} –∑–∞–ø–∏—Å–µ–π</span>
    </div>
    <div class="header-right">
      <input v-model="searchQuery" placeholder="–ü–æ–∏—Å–∫..." class="search-input" @input="$emit('search')" />
      <select v-model="filterRole" class="role-filter">
        <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
        <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
        <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
        <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
      </select>
            <button @click="openAddUserModal"class="btn btn-primary" :disabled="isLoading">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            <button 
          @click="exportToCSV"
          class="btn btn-secondary"
          :disabled="isLoading || selectedUsers.length === 0 && !showAllUsers"
        >
          üì• –≠–∫—Å–ø–æ—Ä—Ç
        </button>
      <button v-if="selectedUsers.length > 0" @click="deleteSelectedUsers" class="btn btn-danger">
        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å ({{ selectedUsers.length }})
      </button>
    </div>
  </div>
</template>