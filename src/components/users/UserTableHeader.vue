<script setup lang="ts">
import { useUserTable } from '@/composables/useUserTable';

const props = defineProps<{
    title: string;
    totalCount: number;
}>();

const {
    deleteSelectedUsers,
    exportToCSV,
    filterRole,
    isLoading,
    openAddUserModal,
    searchQuery,
    selectedUsers,
    showAllUsers
} = useUserTable();
</script>

<template>
    <div class="table-header">
        <div class="header-left">
            <h2>{{ props.title }}</h2>
            <span class="total-count">{{ props.totalCount }} –∑–∞–ø–∏—Å–µ–π</span>
        </div>
        <div class="header-right">
            <input v-model="searchQuery" placeholder="–ü–æ–∏—Å–∫..." class="search-input" @input="$emit('search')" />
            <select v-model="filterRole" class="role-filter">
                <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
            </select>
            <button class="btn btn-primary" :disabled="isLoading" @click="openAddUserModal">
                 + –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            </button>
            <button
                class="btn btn-secondary"
                :disabled="isLoading || (selectedUsers.length === 0 && !showAllUsers)"
                @click="exportToCSV">
                 üì• –≠–∫—Å–ø–æ—Ä—Ç
            </button>
            <button v-if="selectedUsers.length > 0" class="btn btn-danger" @click="deleteSelectedUsers">
                 üóëÔ∏è –£–¥–∞–ª–∏—Ç—å ({{ selectedUsers.length }})
            </button>
        </div>
    </div>
</template>